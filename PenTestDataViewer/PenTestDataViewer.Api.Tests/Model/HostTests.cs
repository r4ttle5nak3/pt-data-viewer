using System.Net;
using Host = PenTestDataViewer.Api.Model.Host;

namespace PenTestDataViewer.Api.Tests.Model
{
    public class HostTests
    {
        [Fact]
        public void IPv4_Should_Be_Returned()
        {
            var raw = new byte[] { 192, 168, 0, 6 };
            var host = new Host { IPv4Raw = raw };

            var parsed = host.IPv4;

            Assert.NotNull(parsed);
            Assert.Equal(IPAddress.Parse("192.168.0.6"), parsed);
        }

        [Fact]
        public void IPv6_Should_Be_Returned()
        {
            var raw = IPAddress.Parse("fe80::42:69ff:fe7c:766c").GetAddressBytes();
            var host = new Host { IPv6Raw = raw };

            var parsed = host.IPv6;

            Assert.NotNull(parsed);
            Assert.Equal(IPAddress.Parse("fe80::42:69ff:fe7c:766c"), parsed);
        }

        [Fact]
        public void IPv4_Should_Not_Be_Returned_Without_Raw_Bytes()
        {
            var host = new Host();

            var parsed = host.IPv4;

            Assert.Null(parsed);
        }

        [Fact]
        public void IPv6_Should_Not_Be_Returned_Without_Raw_Bytes()
        {
            var host = new Host();

            var parsed = host.IPv6;

            Assert.Null(parsed);
        }
    }
}
