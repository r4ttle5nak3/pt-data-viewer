using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace PenTestDataViewer.Api.Tests.Services.Import
{
    public partial class NmapXmlParserTests
    {
        private const string ExampleInput = "<?xml version=\"1.0\"?>\r\n<?xml-stylesheet href=\"file:///usr/local/bin/../share/nmap/nmap.xsl\" type=\"text/xsl\"?>\r\n" +
                "<!-- Nmap 5.59BETA3 scan initiated Fri Sep  9 18:33:41 2011 as:\r\n" +
                "     nmap -T4 -A -p 1-1000 -oX - scanme.nmap.org -->\r\n" +
                "<nmaprun scanner=\"nmap\" args=\"nmap -T4 -A -p 1-1000 -oX - scanme.nmap.org\" start=\"1315618421\"\r\n" +
                "         startstr=\"Fri Sep  9 18:33:41 2011\" version=\"5.59BETA3\" xmloutputversion=\"1.03\">\r\n" +
                " <scaninfo type=\"syn\" protocol=\"tcp\" numservices=\"1000\" services=\"1-1000\"/>\r\n" +
                " <verbose level=\"0\"/>\r\n" +
                " <debugging level=\"0\"/>\r\n" +
                " <host starttime=\"1315618421\" endtime=\"1315618434\">\r\n" +
                "  <status state=\"up\" reason=\"echo-reply\"/>\r\n" +
                "  <address addr=\"74.207.244.221\" addrtype=\"ipv4\"/>\r\n" +
                "  <hostnames>\r\n" +
                "   <hostname name=\"scanme.nmap.org\" type=\"user\"/>\r\n" +
                "   <hostname name=\"li86-221.members.linode.com\" type=\"PTR\"/>\r\n" +
                "  </hostnames>\r\n" +
                "  <ports>\r\n" +
                "   <extraports state=\"closed\" count=\"997\">\r\n" +
                "    <extrareasons reason=\"resets\" count=\"997\"/>\r\n" +
                "   </extraports>\r\n" +
                "   <port protocol=\"tcp\" portid=\"22\">\r\n" +
                "    <state state=\"open\" reason=\"syn-ack\" reason_ttl=\"53\"/>\r\n" +
                "    <service name=\"ssh\" product=\"OpenSSH\" version=\"5.3p1 Debian 3ubuntu7\"\r\n" +
                "             extrainfo=\"protocol 2.0\" ostype=\"Linux\" method=\"probed\" conf=\"10\">\r\n" +
                "     <cpe>cpe:/a:openbsd:openssh:5.3p1</cpe>\r\n" +
                "     <cpe>cpe:/o:linux:kernel</cpe>\r\n" +
                "    </service>\r\n" +
                "    <script id=\"ssh-hostkey\"\r\n" +
                "            output=\"1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)&#xa;\r\n" +
                "                    2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)\"/>\r\n" +
                "   </port>\r\n" +
                "   <port protocol=\"tcp\" portid=\"80\">\r\n" +
                "    <state state=\"open\" reason=\"syn-ack\" reason_ttl=\"53\"/>\r\n " +
                "   <service name=\"http\" product=\"Apache httpd\" version=\"2.2.14\"\r\n" +
                "             extrainfo=\"(Ubuntu)\" method=\"probed\" conf=\"10\">\r\n" +
                "     <cpe>cpe:/a:apache:http_server:2.2.14</cpe>\r\n" +
                "    </service>\r\n" +
                "    <script id=\"http-title\" output=\"Go ahead and ScanMe!\"/>\r\n" +
                "   </port>\r\n" +
                "  </ports>\r\n" +
                "  <os>\r\n" +
                "   <portused state=\"open\" proto=\"tcp\" portid=\"22\"/>\r\n" +
                "   <portused state=\"closed\" proto=\"tcp\" portid=\"1\"/>\r\n" +
                "   <portused state=\"closed\" proto=\"udp\" portid=\"31289\"/>\r\n" +
                "   <osclass type=\"general purpose\" vendor=\"Linux\" osfamily=\"Linux\"\r\n" +
                "            osgen=\"2.6.X\" accuracy=\"100\">\r\n" +
                "    <cpe>cpe:/o:linux:linux_kernel:2.6.39</cpe>\r\n" +
                "   </osclass>\r\n" +
                "   <osmatch name=\"Linux 2.6.39\" accuracy=\"100\" line=\"39278\"/>\r\n" +
                "  </os>\r\n" +
                "  <uptime seconds=\"23450\" lastboot=\"Fri Sep  9 12:03:04 2011\"/>\r\n" +
                "  <distance value=\"11\"/>\r\n" +
                "  <tcpsequence index=\"199\" difficulty=\"Good luck!\"\r\n" +
                "               values=\"49018209,48C3EBED,495A2E7F,493EF30C,48ED43B3,495A9B0C\"/>\r\n" +
                "  <ipidsequence class=\"All zeros\" values=\"0,0,0,0,0,0\"/>\r\n" +
                "  <tcptssequence class=\"1000HZ\"\r\n" +
                "                 values=\"165CC09,165CC6E,165CCD2,165CD36,165CD9A,165CE48\"/>\r\n" +
                "  <trace port=\"256\" proto=\"tcp\">\r\n" +
                "   <!-- Several hop elements removed for brevity -->\r\n" +
                "   <hop ttl=\"9\" ipaddr=\"72.52.92.109\" rtt=\"15.69\" host=\"10gigabitethernet1-1.core1.fmt1.he.net\"/>\r\n" +
                "   <hop ttl=\"10\" ipaddr=\"64.62.250.6\" rtt=\"12.06\" host=\"linode-llc.10gigabitethernet2-3.core1.fmt1.he.net\"/>\r\n" +
                "   <hop ttl=\"11\" ipaddr=\"74.207.244.221\" rtt=\"16.55\" host=\"li86-221.members.linode.com\"/>\r\n" +
                "  </trace>\r\n" +
                "  <times srtt=\"26517\" rttvar=\"19989\" to=\"106473\"/>\r\n" +
                " </host>\r\n" +
                " <runstats>\r\n" +
                "  <finished time=\"1315618434\" timestr=\"Fri Sep  9 18:33:54 2011\" elapsed=\"13.66\"\r\n" +
                "            summary=\"Nmap done at Fri Sep  9 18:33:54 2011; 1 IP address (1 host up)\r\n" +
                "                     scanned in 13.66 seconds\" exit=\"success\"/>\r\n" +
                "  <hosts up=\"1\" down=\"0\" total=\"1\"/>\r\n" +
                " </runstats>\r\n" +
                "</nmaprun>";

        private const string ExampleInputIPv6 = "<?xml version=\"1.0\"?>\r\n<?xml-stylesheet href=\"file:///usr/local/bin/../share/nmap/nmap.xsl\" type=\"text/xsl\"?>\r\n" +
                "<!-- Nmap 5.59BETA3 scan initiated Fri Sep  9 18:33:41 2011 as:\r\n" +
                "     nmap -T4 -A -p 1-1000 -oX - scanme.nmap.org -->\r\n" +
                "<nmaprun scanner=\"nmap\" args=\"nmap -T4 -A -p 1-1000 -oX - scanme.nmap.org\" start=\"1315618421\"\r\n" +
                "         startstr=\"Fri Sep  9 18:33:41 2011\" version=\"5.59BETA3\" xmloutputversion=\"1.03\">\r\n" +
                " <scaninfo type=\"syn\" protocol=\"tcp\" numservices=\"1000\" services=\"1-1000\"/>\r\n" +
                " <verbose level=\"0\"/>\r\n" +
                " <debugging level=\"0\"/>\r\n" +
                " <host starttime=\"1315618421\" endtime=\"1315618434\">\r\n" +
                "  <status state=\"up\" reason=\"echo-reply\"/>\r\n" +
                "  <address addr=\"::1\" addrtype=\"ipv6\"/>\r\n" +
                "  <hostnames>\r\n" +
                "   <hostname name=\"scanme.nmap.org\" type=\"user\"/>\r\n" +
                "   <hostname name=\"li86-221.members.linode.com\" type=\"PTR\"/>\r\n" +
                "  </hostnames>\r\n" +
                "  <ports>\r\n" +
                "   <extraports state=\"closed\" count=\"997\">\r\n" +
                "    <extrareasons reason=\"resets\" count=\"997\"/>\r\n" +
                "   </extraports>\r\n" +
                "   <port protocol=\"tcp\" portid=\"22\">\r\n" +
                "    <state state=\"open\" reason=\"syn-ack\" reason_ttl=\"53\"/>\r\n" +
                "    <service name=\"ssh\" product=\"OpenSSH\" version=\"5.3p1 Debian 3ubuntu7\"\r\n" +
                "             extrainfo=\"protocol 2.0\" ostype=\"Linux\" method=\"probed\" conf=\"10\">\r\n" +
                "     <cpe>cpe:/a:openbsd:openssh:5.3p1</cpe>\r\n" +
                "     <cpe>cpe:/o:linux:kernel</cpe>\r\n" +
                "    </service>\r\n" +
                "    <script id=\"ssh-hostkey\"\r\n" +
                "            output=\"1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)&#xa;\r\n" +
                "                    2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)\"/>\r\n" +
                "   </port>\r\n" +
                "   <port protocol=\"tcp\" portid=\"80\">\r\n" +
                "    <state state=\"open\" reason=\"syn-ack\" reason_ttl=\"53\"/>\r\n " +
                "   <service name=\"http\" product=\"Apache httpd\" version=\"2.2.14\"\r\n" +
                "             extrainfo=\"(Ubuntu)\" method=\"probed\" conf=\"10\">\r\n" +
                "     <cpe>cpe:/a:apache:http_server:2.2.14</cpe>\r\n" +
                "    </service>\r\n" +
                "    <script id=\"http-title\" output=\"Go ahead and ScanMe!\"/>\r\n" +
                "   </port>\r\n" +
                "  </ports>\r\n" +
                "  <os>\r\n" +
                "   <portused state=\"open\" proto=\"tcp\" portid=\"22\"/>\r\n" +
                "   <portused state=\"closed\" proto=\"tcp\" portid=\"1\"/>\r\n" +
                "   <portused state=\"closed\" proto=\"udp\" portid=\"31289\"/>\r\n" +
                "   <osclass type=\"general purpose\" vendor=\"Linux\" osfamily=\"Linux\"\r\n" +
                "            osgen=\"2.6.X\" accuracy=\"100\">\r\n" +
                "    <cpe>cpe:/o:linux:linux_kernel:2.6.39</cpe>\r\n" +
                "   </osclass>\r\n" +
                "   <osmatch name=\"Linux 2.6.39\" accuracy=\"100\" line=\"39278\"/>\r\n" +
                "  </os>\r\n" +
                "  <uptime seconds=\"23450\" lastboot=\"Fri Sep  9 12:03:04 2011\"/>\r\n" +
                "  <distance value=\"11\"/>\r\n" +
                "  <tcpsequence index=\"199\" difficulty=\"Good luck!\"\r\n" +
                "               values=\"49018209,48C3EBED,495A2E7F,493EF30C,48ED43B3,495A9B0C\"/>\r\n" +
                "  <ipidsequence class=\"All zeros\" values=\"0,0,0,0,0,0\"/>\r\n" +
                "  <tcptssequence class=\"1000HZ\"\r\n" +
                "                 values=\"165CC09,165CC6E,165CCD2,165CD36,165CD9A,165CE48\"/>\r\n" +
                "  <trace port=\"256\" proto=\"tcp\">\r\n" +
                "   <!-- Several hop elements removed for brevity -->\r\n" +
                "   <hop ttl=\"9\" ipaddr=\"72.52.92.109\" rtt=\"15.69\" host=\"10gigabitethernet1-1.core1.fmt1.he.net\"/>\r\n" +
                "   <hop ttl=\"10\" ipaddr=\"64.62.250.6\" rtt=\"12.06\" host=\"linode-llc.10gigabitethernet2-3.core1.fmt1.he.net\"/>\r\n" +
                "   <hop ttl=\"11\" ipaddr=\"74.207.244.221\" rtt=\"16.55\" host=\"li86-221.members.linode.com\"/>\r\n" +
                "  </trace>\r\n" +
                "  <times srtt=\"26517\" rttvar=\"19989\" to=\"106473\"/>\r\n" +
                " </host>\r\n" +
                " <runstats>\r\n" +
                "  <finished time=\"1315618434\" timestr=\"Fri Sep  9 18:33:54 2011\" elapsed=\"13.66\"\r\n" +
                "            summary=\"Nmap done at Fri Sep  9 18:33:54 2011; 1 IP address (1 host up)\r\n" +
                "                     scanned in 13.66 seconds\" exit=\"success\"/>\r\n" +
                "  <hosts up=\"1\" down=\"0\" total=\"1\"/>\r\n" +
                " </runstats>\r\n" +
                "</nmaprun>";
    }
}
