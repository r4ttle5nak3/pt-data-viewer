using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Net;

namespace PenTestDataViewer.Api.Model
{
    public class Host
    {
        [Key]
        public Guid Id { get; set; }

        [MinLength(4), MaxLength(4)]
        public byte[]? IPv4Raw { get; set; }

        [MinLength(16), MaxLength(16)]
        public byte[]? IPv6Raw { get; set; }

        [NotMapped]
        public IPAddress? IPv4 { get => IPv4Raw?.Length == 4 ? new IPAddress(IPv4Raw) : null; set => IPv4Raw = value?.GetAddressBytes(); }

        [NotMapped]
        public IPAddress? IPv6 { get => IPv6Raw?.Length == 16 ? new IPAddress(IPv6Raw) : null; set => IPv6Raw = value?.GetAddressBytes(); }

        public string? OS { get; set; }

        public List<Domain> Domains { get; } = new();

        public List<Port> Ports { get; } = new();
    }
}
