using System.ComponentModel.DataAnnotations;
using System.Net;
using System.Net.Sockets;

namespace PenTestDataViewer.Api.Model
{
    public class Host
    {
        [Key]
        public Guid Id { get; set; }

        private string _ipv4 = "";

        public string IPv4
        {
            get => _ipv4;
            set
            {
                if (string.IsNullOrEmpty(value) || (IPAddress.TryParse(value, out IPAddress parsedIp) && parsedIp.AddressFamily == AddressFamily.InterNetwork))
                {
                    _ipv4 = value;
                }
                else
                {
                    throw new ArgumentException($"{value} is not IPv4");
                }
            }
        }

        private string _ipv6 = "";

        public string IPv6
        {
            get => _ipv6;
            set
            {
                if (string.IsNullOrEmpty(value) || (IPAddress.TryParse(value, out IPAddress parsedIp) && parsedIp.AddressFamily == AddressFamily.InterNetworkV6))
                {
                    _ipv6 = value;
                }
                else
                {
                    throw new ArgumentException($"{value} is not IPv6");
                }
            }
        }

        public string OS { get; set; } = "";

        public List<Domain> Domains { get; } = new();

        public List<Port> Ports { get; } = new();
    }
}
