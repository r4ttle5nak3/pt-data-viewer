namespace PenTestDataViewer.Api.DataTransferModel.Domain
{
    public class DomainDto
    {
        public static DomainDto FromDatabaseModel(Model.Domain domain) => new DomainDto
        {
            Id = domain.Id,
            TopDomain = domain.TopDomain,
            SubDomain = domain.SubDomain,
            Hosts = domain.Hosts.Select(DomainHostDto.FromDatabaseModel).ToList(),
        };

        public static Model.Domain ToDatabaseModel(DomainDto dto)
        {
            var model = new Model.Domain
            {
                Id = dto.Id ?? Guid.NewGuid(),
                TopDomain = dto.TopDomain,
                SubDomain = dto.SubDomain,
            };
            if (dto.Hosts?.Any() ?? false)
            {
                model.Hosts.AddRange(dto.Hosts.Select(DomainHostDto.ToDatabaseModel).ToList());
            }

            return model;
        }

        public Guid? Id { get; set; }

        public string TopDomain { get; set; }

        public string SubDomain { get; set; }

        public List<DomainHostDto> Hosts { get; set; } = new();

        public string Name { get => string.IsNullOrWhiteSpace(SubDomain) ? TopDomain : $"{SubDomain}.{TopDomain}"; }
    }
}
