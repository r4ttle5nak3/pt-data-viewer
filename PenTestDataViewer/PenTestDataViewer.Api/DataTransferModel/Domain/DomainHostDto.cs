using System.Net;

namespace PenTestDataViewer.Api.DataTransferModel.Domain
{
    public class DomainHostDto
    {
        public static DomainHostDto FromDatabaseModel(Model.Host host) => new DomainHostDto
        {
            Id = host.Id,
            IPv4 = host.IPv4?.ToString(),
            IPv6 = host.IPv6?.ToString(),
            OS = host.OS?.ToString(),
        };

        public static Model.Host ToDatabaseModel(DomainHostDto dto) => new Model.Host
        {
            Id = dto.Id,
            IPv4 = !string.IsNullOrWhiteSpace(dto.IPv4) ? IPAddress.Parse(dto.IPv4) : null,
            IPv6 = !string.IsNullOrWhiteSpace(dto.IPv6) ? IPAddress.Parse(dto.IPv6) : null,
            OS = dto.OS?.ToString(),
        };

        public Guid Id { get; set; }

        public string? IPv4 { get; set; }

        public string? IPv6 { get; set; }

        public string? OS { get; set; }

    }
}
